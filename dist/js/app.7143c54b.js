(function(){var e={8583:function(e,t,s){var o={"./af":67597,"./af.js":67597,"./ar":71775,"./ar-dz":92677,"./ar-dz.js":92677,"./ar-kw":39793,"./ar-kw.js":39793,"./ar-ly":22214,"./ar-ly.js":22214,"./ar-ma":93920,"./ar-ma.js":93920,"./ar-sa":10614,"./ar-sa.js":10614,"./ar-tn":1451,"./ar-tn.js":1451,"./ar.js":71775,"./az":29326,"./az.js":29326,"./be":25197,"./be.js":25197,"./bg":61390,"./bg.js":61390,"./bm":85930,"./bm.js":85930,"./bn":44792,"./bn-bd":94706,"./bn-bd.js":94706,"./bn.js":44792,"./bo":42840,"./bo.js":42840,"./br":53016,"./br.js":53016,"./bs":6511,"./bs.js":6511,"./ca":43605,"./ca.js":43605,"./cs":46014,"./cs.js":46014,"./cv":20223,"./cv.js":20223,"./cy":86127,"./cy.js":86127,"./da":87448,"./da.js":87448,"./de":80562,"./de-at":93921,"./de-at.js":93921,"./de-ch":56054,"./de-ch.js":56054,"./de.js":80562,"./dv":73483,"./dv.js":73483,"./el":84442,"./el.js":84442,"./en-au":57320,"./en-au.js":57320,"./en-ca":34394,"./en-ca.js":34394,"./en-gb":54391,"./en-gb.js":54391,"./en-ie":81119,"./en-ie.js":81119,"./en-il":69041,"./en-il.js":69041,"./en-in":39106,"./en-in.js":39106,"./en-nz":99062,"./en-nz.js":99062,"./en-sg":41062,"./en-sg.js":41062,"./eo":16418,"./eo.js":16418,"./es":47359,"./es-do":11247,"./es-do.js":11247,"./es-mx":51779,"./es-mx.js":51779,"./es-us":45374,"./es-us.js":45374,"./es.js":47359,"./et":88683,"./et.js":88683,"./eu":67681,"./eu.js":67681,"./fa":88444,"./fa.js":88444,"./fi":3650,"./fi.js":3650,"./fil":69537,"./fil.js":69537,"./fo":91242,"./fo.js":91242,"./fr":7553,"./fr-ca":29763,"./fr-ca.js":29763,"./fr-ch":51e3,"./fr-ch.js":51e3,"./fr.js":7553,"./fy":41104,"./fy.js":41104,"./ga":85588,"./ga.js":85588,"./gd":87782,"./gd.js":87782,"./gl":97023,"./gl.js":97023,"./gom-deva":63962,"./gom-deva.js":63962,"./gom-latn":17102,"./gom-latn.js":17102,"./gu":63193,"./gu.js":63193,"./he":34401,"./he.js":34401,"./hi":41233,"./hi.js":41233,"./hr":84905,"./hr.js":84905,"./hu":2319,"./hu.js":2319,"./hy-am":13366,"./hy-am.js":13366,"./id":43636,"./id.js":43636,"./is":61176,"./is.js":61176,"./it":74595,"./it-ch":34426,"./it-ch.js":34426,"./it.js":74595,"./ja":13724,"./ja.js":13724,"./jv":28927,"./jv.js":28927,"./ka":42643,"./ka.js":42643,"./kk":5706,"./kk.js":5706,"./km":6713,"./km.js":6713,"./kn":19025,"./kn.js":19025,"./ko":27631,"./ko.js":27631,"./ku":90019,"./ku.js":90019,"./ky":84349,"./ky.js":84349,"./lb":65017,"./lb.js":65017,"./lo":51609,"./lo.js":51609,"./lt":95705,"./lt.js":95705,"./lv":68886,"./lv.js":68886,"./me":2028,"./me.js":2028,"./mi":94575,"./mi.js":94575,"./mk":14990,"./mk.js":14990,"./ml":64407,"./ml.js":64407,"./mn":85497,"./mn.js":85497,"./mr":57740,"./mr.js":57740,"./ms":15752,"./ms-my":20445,"./ms-my.js":20445,"./ms.js":15752,"./mt":905,"./mt.js":905,"./my":30863,"./my.js":30863,"./nb":49396,"./nb.js":49396,"./ne":95464,"./ne.js":95464,"./nl":73183,"./nl-be":38467,"./nl-be.js":38467,"./nl.js":73183,"./nn":73195,"./nn.js":73195,"./oc-lnc":10146,"./oc-lnc.js":10146,"./pa-in":41578,"./pa-in.js":41578,"./pl":23862,"./pl.js":23862,"./pt":81147,"./pt-br":19472,"./pt-br.js":19472,"./pt.js":81147,"./ro":10692,"./ro.js":10692,"./ru":97498,"./ru.js":97498,"./sd":76821,"./sd.js":76821,"./se":82512,"./se.js":82512,"./si":98309,"./si.js":98309,"./sk":31782,"./sk.js":31782,"./sl":48861,"./sl.js":48861,"./sq":46186,"./sq.js":46186,"./sr":64209,"./sr-cyrl":25954,"./sr-cyrl.js":25954,"./sr.js":64209,"./ss":3210,"./ss.js":3210,"./sv":75440,"./sv.js":75440,"./sw":2416,"./sw.js":2416,"./ta":74500,"./ta.js":74500,"./te":99823,"./te.js":99823,"./tet":19994,"./tet.js":19994,"./tg":89397,"./tg.js":89397,"./th":92524,"./th.js":92524,"./tk":39548,"./tk.js":39548,"./tl-ph":95414,"./tl-ph.js":95414,"./tlh":49005,"./tlh.js":49005,"./tr":42958,"./tr.js":42958,"./tzl":41426,"./tzl.js":41426,"./tzm":97844,"./tzm-latn":93264,"./tzm-latn.js":93264,"./tzm.js":97844,"./ug-cn":24423,"./ug-cn.js":24423,"./uk":5008,"./uk.js":5008,"./ur":74102,"./ur.js":74102,"./uz":75454,"./uz-latn":18365,"./uz-latn.js":18365,"./uz.js":75454,"./vi":30217,"./vi.js":30217,"./x-pseudo":90818,"./x-pseudo.js":90818,"./yo":84817,"./yo.js":84817,"./zh-cn":56582,"./zh-cn.js":56582,"./zh-hk":47064,"./zh-hk.js":47064,"./zh-mo":2397,"./zh-mo.js":2397,"./zh-tw":41430,"./zh-tw.js":41430};function r(e){var t=a(e);return s(t)}function a(e){if(!s.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id=8583},11516:function(e,t,s){"use strict";var o=s(20144),r=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("MainPage")],1)},a=[],i=function(){var e=this,t=e._self._c;return t("div",[t("h2",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],staticStyle:{float:"left","margin-right":"2%","margin-top":"0.3%","margin-left":"1%"}},[e._v("HToolBox")]),t("a-menu",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],attrs:{mode:"horizontal"},model:{value:e.current,callback:function(t){e.current=t},expression:"current"}},[e.isUser?t("a-menu-item",{key:"home"},[t("router-link",{attrs:{to:"/home"}},[t("a-icon",{attrs:{type:"home"}}),e._v("主页")],1)],1):e._e(),e.isUser?t("a-menu-item",{key:"app"},[t("router-link",{attrs:{to:"/app"}},[t("a-icon",{attrs:{type:"appstore"}}),e._v("应用")],1)],1):e._e(),e.isAdmin?t("a-menu-item",{key:"control"},[t("a-icon",{attrs:{type:"control"}}),e._v("后台管理 ")],1):e._e(),t("a-sub-menu",{staticStyle:{float:"right"}},[t("span",{staticClass:"submenu-title-wrapper",attrs:{slot:"title"},slot:"title"},[t("a-icon",{attrs:{type:"user"}}),e._v(e._s(e.$store.state.UserOptions.users.username))],1),t("a-menu-item-group",{attrs:{title:"操作"}},[0===e.acc?t("a-menu-item",{key:"login"},[e._v(" 登录 ")]):e._e(),e.isUser?t("a-menu-item",{key:"personal_center"},[e._v(" 个人中心 ")]):e._e(),e.isUser?t("a-menu-item",{key:"settings"},[e._v(" 设置 ")]):e._e(),e.isUser?t("a-menu-item",{key:"logout"},[t("router-link",{attrs:{to:"/logout"}},[e._v("退出登录")])],1):e._e()],1)],1)],1),t("router-view")],1)},n=[];const c={methods:{getCookie(e){let t=e+"=",s=document.cookie.split(";");for(let o=0;o<s.length;o++){let e=s[o].trim();if(0===e.indexOf(t))return e.substring(t.length,e.length)}return""},setCookie(e,t,s){let o=new Date;o.setTime(o.getTime()+24*s*60*60*1e3);let r="expires="+o.toGMTString();document.cookie=e+"="+t+"; "+r},clearCookies(){let e=document.cookie.split("; ");for(let t=0;t<e.length;t++){let s=e[t],o=s.indexOf("="),r=o>-1?s.substr(0,o):s;document.cookie=r+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT"}}}};let l;var m={name:"HomeBanner",components:{},data(){return{current:["login"]}},mixins:[c],computed:{acc(){return this.$store.state.UserOptions.users.accessN||0},isUser(){return this.$store.state.UserOptions.users.accessN>=1},isAdmin(){return this.$store.state.UserOptions.users.accessN>=2},show(){return-1===this.$route.path.indexOf("/AskDecision")}},mounted(){this.$store.dispatch("UserOptions/UserAccess",{userid:this.getCookie("userid"),accessToken:this.getCookie("accessToken")}).then((()=>{-1===this.$store.state.UserOptions.users.accessN&&(window.location.href="/BlockIP",clearInterval(l))})),l=setInterval((()=>{this.$store.dispatch("UserOptions/UserAccess",{userid:this.getCookie("userid"),accessToken:this.getCookie("accessToken")}).then((()=>{-1===this.$store.state.UserOptions.users.accessN&&(window.location.href="/BlockIP",clearInterval(l))}))}),12e5)},beforeDestroy(){clearInterval(l)}},u=m,d=s(1001),p=(0,d.Z)(u,i,n,!1,null,"1bc130d8",null),h=p.exports,g={name:"App",components:{MainPage:h},mixins:[c],mounted(){if(console.log("App.vue mounted"),this.$bus.$on("getLoginMsg",(e=>{"SUCCESS"!==e&&this.$message.error(e)})),this.$bus.$on("Msg",(e=>{"error"===e.type?this.$message.error(e.text):"success"===e.type?this.$message.success(e.text):"warning"===e.type?this.$message.warning(e.text):"info"===e.type&&this.$message.info(e.text)})),null!==this.getCookie("token")){let e={token:this.getCookie("token"),userid:this.getCookie("userid"),accessToken:this.getCookie("accessToken"),username:this.getCookie("username")};this.$store.commit("UserOptions/LOGIN",e)}this.$store.dispatch("UserOptions/UserAccess",{userid:this.getCookie("userid"),accessToken:this.getCookie("accessToken")})}},f=g,b=(0,d.Z)(f,r,a,!1,null,null,null),v=b.exports,k=s(20520),y=(s(76118),s(20629)),_=s(66211);const w={namespaced:!0,actions:{login(e,t){const s=new FormData;s.append("userid",t.userid),s.append("token",t.token),s.append("accessToken",t.accessToken),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/login.php",s).then((e=>{let s=e.data;200===s.code?(this.$store.commit("UserOptions/LOGIN",t),o.ZP.prototype.$bus.$emit("getLoginMsg","SUCCESS")):o.ZP.prototype.$bus.$emit("getLoginMsg",s.text)})).catch((e=>{o.ZP.prototype.$bus.$emit("getLoginMsg",e)})),e.commit("LOGIN",t)},UserAccess(e,t){const s=new FormData;s.append("userid",t.userid),s.append("accessToken",t.accessToken),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/getAccess.php",s).then((t=>{let s=t.data;if(200===s.code)switch(s.access){case"user":e.commit("SET_ACCESS",1);break;case"admin":e.commit("SET_ACCESS",2);break;case"root":e.commit("SET_ACCESS",3);break;default:e.commit("SET_ACCESS",0);break}else 0===s.code?e.commit("SET_ACCESS",-1):e.commit("SET_ACCESS",0)})).catch((()=>{e.commit("SET_ACCESS",0)}))}},mutations:{LOGIN(e,t){e.users.id=t.userid,e.users.token=t.token,e.users.access=t.accessToken,e.users.username=t.username},SET_ACCESS(e,t){e.users.accessN=t}},state:{users:{id:"",token:"",access:"",username:"未登录",accessN:""}},getters:{}},x={namespaced:!0,actions:{commit(e,t){const s=new FormData;s.append("userid",t.userid),s.append("token",t.token),s.append("accessToken",t.accessToken),s.append("findUserID",t.creator+","+t.BelongTo),_.Z.post("http://home.caizhixiao.com.cn/Api/Account/findUserID.php",s).then((s=>{if(200===s.data.code){t.creator=s.data.result[0],t.BelongTo=s.data.result[1],t.usage=JSON.parse(t.usage),t.LastUpdateTime=new Date(t.LastUpdateTime),t.endbyT=new Date(t.endby);let o=new Date(t.endby)-new Date;t.endby=o>0?o:0,e.commit("COMMIT",t)}}),(e=>{o.ZP.prototype.$bus.$emit("MedQuestErrMsg",e)}))}},mutations:{COMMIT(e,t){e.item=t}},state:{item:{}},getters:{}};o.ZP.use(y.ZP);var $=new y.ZP.Store({modules:{UserOptions:w,MedicineOptions:x}}),j=s(78345),T=function(){var e=this,t=e._self._c;return t("div",[t("a-result",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.UserOptions.users.accessN,expression:"$store.state.UserOptions.users.accessN"}],attrs:{title:"您已登录，无需再次登录!"},scopedSlots:e._u([{key:"extra",fn:function(){},proxy:!0}])}),t("div",{directives:[{name:"show",rawName:"v-show",value:!e.$store.state.UserOptions.users.accessN,expression:"!$store.state.UserOptions.users.accessN"}],staticClass:"loginform"},[t("h1",{staticStyle:{"text-align":"center"}},[e._v("登录")]),t("a-form",{staticClass:"login-form",attrs:{id:"components-form-demo-normal-login",form:e.form},on:{submit:e.handleSubmit}},[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["username",{rules:[{required:!0,message:"用户名不能为空"}]}],expression:"[\n        'username',\n        { rules: [{ required: true, message: '用户名不能为空' }] },\n      ]"}],attrs:{placeholder:"用户名"}},[t("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{rules:[{required:!0,message:"密码不能为空"}]}],expression:"[\n        'password',\n        { rules: [{ required: true, message: '密码不能为空' }] },\n      ]"}],attrs:{type:"password",placeholder:"密码"}},[t("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t("a-form-item",[t("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:["remember",{valuePropName:"checked",initialValue:!0}],expression:"[\n        'remember',\n        {\n          valuePropName: 'checked',\n          initialValue: true,\n        },\n      ]"}]},[e._v(" Remember me ")]),t("a-button",{staticClass:"login-form-button",attrs:{type:"primary","html-type":"submit",loading:e.isLoading}},[e._v(" 登录 ")]),t("br"),t("br")],1)],1)],1)],1)},O=[],M=(s(70560),{name:"UserLogin",data(){return{isLoading:!1}},mixins:[c],computed:{isLogin(){return 0!==this.$store.state.UserOptions.users.accessN}},beforeCreate(){this.form=this.$form.createForm(this,{name:"normal_login"})},methods:{handleSubmit(e){e.preventDefault(),this.form.validateFields(((e,t)=>{if(!e){const e=new FormData;e.append("username",t.username),e.append("password",t.password),this.isLoading=!0,_.Z.post("https://home.caizhixiao.com.cn/Api/Account/login.php",e).then((e=>{this.isLoading=!1;let s=e.data;200===s.code?(s={...s,username:t.username},this.$store.commit("UserOptions/LOGIN",s),this.$store.dispatch("UserOptions/UserAccess",{userid:s.userid,accessToken:s.accessToken}),this.$message.success("登录成功"),this.setCookie("token",s.token,.5),this.setCookie("userid",s.userid,.5),this.setCookie("accessToken",s.accessToken,.5),this.setCookie("username",s.username,.5),setTimeout((()=>{this.$router.push("/app")}),500)):900===s.code?this.$router.push({path:"/blocked",query:{username:t.username,password:t.password,msg:s.text}}):0===s.code?this.$router.push({path:"/blockIP"}):this.$message.error(s.text)})).catch((e=>{this.$message.error(e)}))}}))}},mounted(){this.$store.state.UserOptions.users.accessN&&setTimeout((()=>{this.$router.push("/app")}),100)}}),C=M,A=(0,d.Z)(C,T,O,!1,null,"9e1367dc",null),S=A.exports,U=function(){var e=this;e._self._c;return e._m(0)},D=[function(){var e=this,t=e._self._c;return t("div",[t("h1",[e._v("你好--HomePage.vue")])])}],N={name:"HomePage"},I=N,z=(0,d.Z)(I,U,D,!1,null,"197d4858",null),E=z.exports,P=function(){var e=this,t=e._self._c;return t("div",[t("h2",{directives:[{name:"show",rawName:"v-show",value:!e.InApp,expression:"!InApp"}],staticStyle:{"margin-top":"1%"}},[e._v("应用列表:")]),t("a-list",{directives:[{name:"show",rawName:"v-show",value:!e.InApp,expression:"!InApp"}],attrs:{grid:{gutter:16,xs:1,sm:2,md:4,lg:4,xl:6,xxl:3},"data-source":e.outputData},scopedSlots:e._u([{key:"renderItem",fn:function(s){return t("a-list-item",{},[t("a-card",{key:s.id,attrs:{title:s.title}},[e._v(" "+e._s(s.text)),t("br"),t("router-link",{staticClass:"ant-btn ant-btn-primary",attrs:{to:{path:"/app/"+s.id},disabled:!s.available,tag:"a-button"}},[e._v(" 前往 ")])],1)],1)}}])}),t("router-view")],1)},Z=[];const L=[{title:"药品过期提醒",text:"",id:"8yuzxcew97",available:!0,requireAccess:1},{title:"档案管理",text:"用于集中管理医院记录",id:"vcx978cxz23",available:!1,requireAccess:1},{title:"网站运行/开发日志审计",text:"",id:"cxz978qwi9e",available:!0,requireAccess:3}];var q={data(){return{data:L}},computed:{InApp(){return this.$route.path.startsWith("/app/")},outputData(){return this.data.filter((e=>this.$store.state.UserOptions.users.accessN>=e.requireAccess&&e.available))}}},B=q,F=(0,d.Z)(B,P,Z,!1,null,null,null),R=F.exports,Y=function(){var e=this,t=e._self._c;return t("div",[t("a-spin",{attrs:{spinning:e.spinning,delay:e.delayTime}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.InOtherPage,expression:"!InOtherPage"}],staticClass:"tableContainer"},[t("a-page-header",{staticStyle:{border:"1px solid rgb(235, 237, 240)"},attrs:{title:e.AppName,"sub-title":""},on:{back:()=>{this.$router.push({name:"MyApp"})}}}),t("br"),t("br"),t("div",{staticClass:"mainBody",staticStyle:{width:"96%","justify-content":"center","align-items":"center","margin-left":"2%","margin-top":"2%"}},[t("a-button",{attrs:{type:"primary"},on:{click:function(t){e.InOtherPage=!0,e.$router.push({name:"MedicineAdd"})}}},[t("a-icon",{attrs:{type:"plus-circle"}}),e._v(" 添加 ")],1),t("a-select",{staticStyle:{width:"150px",float:"right"},attrs:{mode:"multiple",size:e.size,placeholder:"按名字检索"},on:{change:e.handleChange,popupScroll:e.popupScroll}},[t("a-icon",{attrs:{slot:"suffixIcon",type:"search"},slot:"suffixIcon"}),e._l(e.name_listo,(function(s,o){return t("a-select-option",{key:o},[e._v(" "+e._s(s)+" ")])}))],2),t("br"),t("br"),t("br"),[t("a-table",{directives:[{name:"show",rawName:"v-show",value:!e.spinning,expression:"!spinning"}],attrs:{columns:e.columns,"data-source":e.data,pagination:{pageSize:10},rowKey:e=>e.id},scopedSlots:e._u([{key:"endby",fn:function(s,o){return t("span",{},[t("a-tag",{attrs:{color:o.stat>=0?"purple":o.endby>14?"green":o.endby>7?"blue":0===o.endby?"red":"orange"}},[e._v(" "+e._s(o.stat>=0?o.stat:o.endby)+e._s(o.stat>=0?"天(停用)":"天")+" ")])],1)}},{key:"operation",fn:function(s,o){return t("span",{},[t("a-button",{attrs:{type:"link"},on:{click:()=>{e.details(o.id)}}},[e._v("详情")])],1)}}])})]],2)],1)]),t("router-view",{directives:[{name:"show",rawName:"v-show",value:e.InOtherPage,expression:"InOtherPage"}],key:e.$route.fullPath})],1)},H=[],G=s(9498),J=s.n(G);const V=[{title:"药品名称",dataIndex:"name",width:"30%",sorter:(e,t)=>e.name.length-t.name.length},{title:"科室",dataIndex:"room",width:"20%",sorter:(e,t)=>e.room.length-t.room.length},{title:"剩余",dataIndex:"endby",width:"20%",scopedSlots:{customRender:"endby"},defaultSortOrder:"ascend",sorter:(e,t)=>{const s=99999999;let o=e.stat>=0?s+e.stat:e.endby,r=t.stat>=0?s+t.stat:t.endby;return o-r}},{title:"属于",dataIndex:"BelongTo",width:"20%",sorter:(e,t)=>e.BelongTo.length-t.BelongTo.length},{title:"操作",dataIndex:"operation",width:"10%",scopedSlots:{customRender:"operation"}}];var W={data(){return{AppName:"药品过期提醒",columns:V,size:"default",name_list:[],InOtherPage:!1,selected:"",data:[],spinning:!0,delayTime:10}},methods:{handleChange(e){let t="";for(let s=0;s<e.length;s++)t+=this.name_listo[e[s]]+",";this.selected=t,this.getData(this.selected)},popupScroll(){console.log("popupScroll")},getData(e){const t=new FormData;t.append("token",this.$store.state.UserOptions.users.token),t.append("userid",this.$store.state.UserOptions.users.id),t.append("accessToken",this.$store.state.UserOptions.users.access),t.append("names",e),this.data=[],_.Z.post("https://home.caizhixiao.com.cn/Api/App/User/8yuzxcew97/get.php",t).then((e=>{const t=e.data.result;if(Object.freeze(t),200!==e.data.code)return void this.$message.error(e.data.text);let s=[];for(let a in t)s.push(t[a].BelongTo),s.push(t[a].creator);let o="";for(let a=0;a<s.length;a++)0!==a&&(o+=","),o+=s[a];const r=new FormData;r.append("userid",this.$store.state.UserOptions.users.id),r.append("token",this.$store.state.UserOptions.users.token),r.append("accessToken",this.$store.state.UserOptions.users.access),r.append("findUserID",o),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/findUserID.php",r).then((e=>{if(200!==e.data.code)return this.$message.error(e.data.result),e.data.result;for(let o=0;o<t.length;o++){let r=t[o];r.BelongTo=e.data.result[2*o],r.creator=e.data.result[2*o+1],r.creatorID=s[2*o+1],r.usage=JSON.parse(r.usage),r.LastUpdateTime=J()(1e3*r.LastUpdateTime).format("YYYY-MM-DD HH:mm:ss"),r.endbyT=new Date(r.endby);let a=new Date(r.endby)-new Date;a=a/24/60/60/1e3,a=a.toFixed(1),r.endby=a>0?a:0,this.data.push(r)}}),(e=>(this.$message.error(e),e)))}))},getNameList(){const e=new FormData;e.append("token",this.$store.state.UserOptions.users.token),e.append("userid",this.$store.state.UserOptions.users.id),e.append("accessToken",this.$store.state.UserOptions.users.access),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/getUserName.php",e).then((e=>(this.name_list=e.data.result,200===e.data.code?e:[])),(e=>{this.$message.error(e)}))},search(){let e="";for(let t=0;t<this.name_list.length;t++)e+=this.name_list[t]+",";this.getData(e)},details(e){for(let t=0;t<this.data.length;t++)if(this.data[t].id===e){this.$store.commit("MedicineOptions/COMMIT",{...this.data[t]}),this.InOtherPage=!0,this.$router.push({name:"MedicineDetails"});break}}},computed:{name_listo(){return this.name_list.filter((e=>-1===e.indexOf("testAccount")))}},mounted(){setTimeout((()=>{this.getNameList()}),100),setTimeout((()=>{this.spinning=!this.spinning}),1e3),this.$bus.$on("quitDetails",(e=>{this.InOtherPage=!e,this.getNameList(),this.getData(this.selected)})),this.$bus.$on("MedQuestErrMsg",(e=>{this.$message.error(e)}))}},K=W,Q=(0,d.Z)(K,Y,H,!1,null,"96fe2a7c",null),X=Q.exports,ee=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mainContainer",staticStyle:{"margin-top":"8%","align-content":"center","justify-content":"center",width:"40%","margin-left":"30%"}},[t("a-result",{attrs:{status:"error",title:"没有权限访问","sub-title":"请检查您是否登录/您是否有权限访问此页面."},scopedSlots:e._u([{key:"extra",fn:function(){return[t("a-button",{key:"console",attrs:{type:"primary"},on:{click:e.goLogin}},[e._v(" 前去登录 ")])]},proxy:!0}])},[t("div",{staticClass:"desc"},[t("p",{staticStyle:{"font-size":"16px"}},[t("strong",[e._v("可能的问题:")])]),t("p",[t("a-icon",{style:{color:"red"},attrs:{type:"close-circle"}}),e._v(" 您尚未登录 "),t("a",{on:{click:function(t){return e.goLogin()}}},[e._v("前去登录>")])],1),t("p",[t("a-icon",{style:{color:"red"},attrs:{type:"close-circle"}}),e._v(" 您账户的权限不足，请联系管理员，提升权限 ")],1),t("p",[t("a-icon",{style:{color:"red"},attrs:{type:"close-circle"}}),e._v(" 网络波动，您的账户验证请求未能到达服务器 ")],1)])])],1)},te=[],se={name:"NoAccess",data(){return{}},methods:{goLogin(){this.$router.push("/")}}},oe=se,re=(0,d.Z)(oe,ee,te,!1,null,"78bb08e3",null),ae=re.exports,ie=function(){var e=this,t=e._self._c;return t("div",[t("a-page-header",{staticStyle:{border:"1px solid rgb(235, 237, 240)"},attrs:{title:"添加药品","sub-title":""},on:{back:()=>{this.$bus.$emit("quitDetails",!0),this.$router.go(-1)}}}),t("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[t("br"),t("br"),t("a-form-model-item",{ref:"creatorID",attrs:{label:"创建者ID"}},[t("a-input",{attrs:{disabled:"true"},model:{value:e.form.creator,callback:function(t){e.$set(e.form,"creator",t)},expression:"form.creator"}})],1),t("a-form-model-item",{ref:"name",attrs:{label:"药品名称",prop:"name"}},[t("a-input",{on:{blur:()=>{e.$refs.name.onFieldBlur()}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("a-form-model-item",{attrs:{label:"拥有数量(单位)",prop:"have"}},[t("a-input-number",{attrs:{id:"have",min:0,max:1e4,step:.1},on:{change:e.onChange},model:{value:e.form.have,callback:function(t){e.$set(e.form,"have",t)},expression:"form.have"}})],1),t("a-form-model-item",{ref:"room",attrs:{label:"科室",prop:"room"}},[t("a-input",{on:{blur:()=>{e.$refs.room.onFieldBlur()}},model:{value:e.form.room,callback:function(t){e.$set(e.form,"room",t)},expression:"form.room"}})],1),t("a-form-model-item",{attrs:{label:"所属人"}},[t("a-select",{attrs:{placeholder:"请选择药品的所属人"},model:{value:e.form.BelongTo,callback:function(t){e.$set(e.form,"BelongTo",t)},expression:"form.BelongTo"}},e._l(e.name_listo,(function(s,o){return t("a-select-option",{key:o,attrs:{value:s}},[e._v(" "+e._s(s)+" ")])})),1)],1),t("a-form-model-item",{attrs:{label:"药品用法",prop:"des1c"}},[e._v(" 一天"),t("a-input-number",{attrs:{id:"usage_times",min:1,max:10,size:"small"},on:{change:e.onChange},model:{value:e.form.usage.times,callback:function(t){e.$set(e.form.usage,"times",t)},expression:"form.usage.times"}}),e._v(" 次, 一次"),t("a-input-number",{attrs:{id:"usage_once",min:.1,max:10,step:.1,size:"small"},on:{change:e.onChange},model:{value:e.form.usage.once,callback:function(t){e.$set(e.form.usage,"once",t)},expression:"form.usage.once"}}),e._v("个(单位) ")],1),t("a-form-model-item",{attrs:{label:"状态"}},[t("a-switch",{model:{value:e.form.open,callback:function(t){e.$set(e.form,"open",t)},expression:"form.open"}})],1),t("a-form-model-item",{attrs:{label:"描述",prop:"desc"}},[t("a-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),t("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[t("a-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v(" 提交 ")]),t("a-button",{staticStyle:{"margin-left":"10px"},on:{click:e.resetForm}},[e._v(" 重置 ")])],1)],1)],1)},ne=[],ce={data(){return{labelCol:{span:4},wrapperCol:{span:14},other:"",name_list:[],form:{name:"",desc:"",room:"",stat:-1,open:!0,endby:0,creator:this.$store.state.UserOptions.users.id,belongTo:void 0,have:0,usage:{times:1,once:1}},rules:{name:[{required:!0,message:"请输入药品名称",trigger:"blur"},{min:2,max:12,message:"长度必须为2~12位",trigger:"blur"}]}}},methods:{onSubmit(){this.$refs.ruleForm.validate((e=>{if(!e)return console.log("ERR"),!1;{let e=this.form.usage.once*this.form.usage.times,t=Math.floor(this.form.have/e);if(!1===this.form.open)this.form.stat=t;else{let e=new Date;e.setDate(e.getDate()+t),this.form.endby=e}const s=new FormData;s.append("token",this.$store.state.UserOptions.users.token),s.append("userid",this.$store.state.UserOptions.users.id),s.append("accessToken",this.$store.state.UserOptions.users.access),s.append("data",JSON.stringify(this.form)),_.Z.post("https://home.caizhixiao.com.cn/Api/App/User/8yuzxcew97/add.php",s).then((e=>{200===e.data.code?(this.$message.success(e.data.text),this.$router.replace({name:"SuccessPage"})):this.$message.error(e.data.text)}),(e=>{this.$message.error(e)}))}}))},resetForm(){this.$refs.ruleForm.resetFields()},getNameList(){const e=new FormData;e.append("token",this.$store.state.UserOptions.users.token),e.append("userid",this.$store.state.UserOptions.users.id),e.append("accessToken",this.$store.state.UserOptions.users.access),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/getUserName.php",e).then((e=>(this.name_list=e.data.result,200===e.data.code?e:[])),(e=>{this.$message.error(e)}))}},computed:{name_listo(){return this.name_list.filter((e=>-1===e.indexOf("testAccount")))}},mounted(){setTimeout((()=>{this.getNameList(),void 0===this.form.creator&&this.$message.error("无法获取UID，请刷新重试!")}),100)}},le=ce,me=(0,d.Z)(le,ie,ne,!1,null,"37c22fe5",null),ue=me.exports,de=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"background-color":"#F5F5F5",padding:"24px"}},[t("a-page-header",{attrs:{title:"药品详情","sub-title":"创建者:"+e.item.creator,ghost:!1},on:{back:()=>{this.$bus.$emit("quitDetails",!0),this.$router.go(-1)}}},[t("template",{slot:"tags"},[t("a-tag",{attrs:{color:"-1"===e.item.stat?"blue":"red"}},[e._v(" "+e._s("-1"===e.item.stat?"启用":"停用")+" ")])],1),t("template",{slot:"extra"},[t("a-button",{directives:[{name:"show",rawName:"v-show",value:!e.isEditingMode,expression:"!isEditingMode"}],key:"1",attrs:{type:"primary"},on:{click:e.edit_use}},[t("a-icon",{attrs:{type:"edit"}}),e._v("编辑 ")],1),t("a-button",{directives:[{name:"show",rawName:"v-show",value:!e.isEditingMode,expression:"!isEditingMode"}],key:"2",attrs:{type:"danger"},on:{click:e.delete_item}},[t("a-icon",{attrs:{type:"delete"}}),e._v("删除 ")],1),t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.isEditingMode,expression:"isEditingMode"}],key:"3",attrs:{type:"primary"}},[t("a-icon",{attrs:{type:"check-circle"}}),e._v("确认 ")],1),t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.isEditingMode,expression:"isEditingMode"}],key:"4",attrs:{type:"danger"},on:{click:e.quit_edit}},[t("a-icon",{attrs:{type:"close-circle"}}),e._v("取消 ")],1)],1),t("a-row",{attrs:{type:"flex"}},[t("a-statistic",{attrs:{title:"药品名称",value:e.item.name}}),t("a-statistic",{style:{margin:"0 32px"},attrs:{title:"剩余(天)",value:e.item.stat>=0?e.item.stat:e.item.endby}}),t("a-statistic",{attrs:{title:"科室",value:e.item.room}}),t("a-statistic",{style:{margin:"0 32px"},attrs:{title:"属于",value:e.item.BelongTo}})],1),t("br"),t("br"),t("br"),t("br"),t("br"),t("a-descriptions",{attrs:{title:"",bordered:""}},[t("a-descriptions-item",{attrs:{label:"名称"}},[e._v(" "+e._s(e.item.name)+" ")]),t("a-descriptions-item",{attrs:{label:"科室"}},[e._v(" "+e._s(e.item.room)+" ")]),t("a-descriptions-item",{attrs:{label:"所属人"}},[e._v(" "+e._s(e.item.BelongTo)+" ")]),t("a-descriptions-item",{attrs:{label:"剩余天数"}},[e._v(" "+e._s(e.item.stat>=0?e.item.stat:e.item.endby)+e._s(e.item.stat>=0?"天(停用)":"天")+" ")]),t("a-descriptions-item",{attrs:{label:"用尽日期",span:2}},[e._v(" "+e._s(e.item.stat>=0?"":e.endbyT_format)+" ")]),t("a-descriptions-item",{attrs:{label:"状态",span:3}},[t("a-badge",{attrs:{status:e.item.stat>=0?"default":e.item.endby>14?"success":e.item.endby>7?"processing":0===e.item.endby?"error":"warning",text:e.item.stat>=0?"停用":e.item.endby>14?"安全":e.item.endby>7?"警告":0===e.item.endby?"用尽":"危险"}})],1),t("a-descriptions-item",{attrs:{label:"用法用量",span:2}},[e._v(" "+e._s("一次"+e.item.usage.once+"个(单位) , 一天"+e.item.usage.times+"次")+" ")]),t("a-descriptions-item",{attrs:{label:"上次更新",span:3}},[e._v(" "+e._s(e.LastUpdateTime_format)+" ")]),t("a-descriptions-item",{attrs:{label:"描述/备注",span:3}},[e._v(" "+e._s(e.item.description)+" "),t("a-empty",{directives:[{name:"show",rawName:"v-show",value:""===e.item.description,expression:"item.description === ''"}]}),t("div",{directives:[{name:"show",rawName:"v-show",value:""!==e.item.description,expression:"item.description !== ''"}]},[t("br"),t("br"),t("br"),t("br"),t("br")])],1),t("a-descriptions-item",{attrs:{label:"更新日志",span:3}},[t("a-empty")],1)],1),t("br"),t("br")],2)],1)},pe=[],he={name:"MedicineDetails",data(){return{activeKey:["1"],expandIconPosition:"right",isEditingMode:!1,delAlertVisible:!1,button:{text:"我确定(5s后可用)",disabled:!0}}},methods:{handleClick(e){e.stopPropagation()},edit_use(){this.isEditingMode=!0,this.$router.push({name:"MedicineEdit"})},quit_edit(){let e=this;this.$confirm({title:"确定退出编辑模式?",content:"你的所有更改将不会被保存!",okText:"我确定",okType:"danger",cancelText:"再想想",onOk(){e.isEditingMode=!1},onCancel(){}})},delete_item(){let e=this;this.$confirm({title:"确认删除这条药品信息?",content:"删除操作无法撤销",okText:"我确定",okType:"danger",cancelText:"再想想",onOk(){const t=new FormData;t.append("medid",e.item.id),t.append("userid",e.$store.state.UserOptions.users.id),t.append("token",e.$store.state.UserOptions.users.token),t.append("accessToken",e.$store.state.UserOptions.users.access),_.Z.post("https://home.caizhixiao.com.cn/Api/App/User/8yuzxcew97/dlt.php",t).then((t=>{console.log(t.data),200===t.data.code?(e.$message.success("删除成功"),e.$bus.$emit("quitDetails",!0),setTimeout((()=>{e.$router.go(-1)}),100)):e.$message.error("删除失败,"+t.data.text)})).catch((t=>{e.$message.error("删除失败,"+t)}))},onCancel(){}})}},computed:{item(){return this.$store.state.MedicineOptions.item},endbyT_format(){return J()(this.item.endbyT).format("YYYY-MM-DD HH:mm:ss")},LastUpdateTime_format(){return J()(this.item.LastUpdateTime).format("YYYY-MM-DD HH:mm:ss")}},mounted(){}},ge=he,fe=(0,d.Z)(ge,de,pe,!1,null,"64eeb9f2",null),be=fe.exports,ve=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mainContainer",staticStyle:{"margin-top":"8%","align-content":"center","justify-content":"center",width:"40%","margin-left":"30%"}},[t("a-result",{attrs:{status:"success",title:"请求成功","sub-title":"您的请求已经成功处理"},scopedSlots:e._u([{key:"extra",fn:function(){return[t("a-button",{key:"console",attrs:{type:"primary"},on:{click:e.goIndex}},[e._v(" 前去主页 ")])]},proxy:!0}])})],1)},ke=[],ye={name:"SuccessPage",methods:{goIndex(){this.$bus.$emit("quitDetails",!0),this.$router.replace({name:"MedicineList"})}}},_e=ye,we=(0,d.Z)(_e,ve,ke,!1,null,"33e0c96e",null),xe=we.exports,$e=function(){var e=this,t=e._self._c;return t("a-result",{attrs:{status:"success",title:"账号已解锁","sub-title":"您的账号已解锁，您可以重新登录."}})},je=[],Te={name:"EmailAccept",data(){return{}},mounted(){const e=new FormData;e.append("BlockID",this.$route.params.id),e.append("RequestType","approve"),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/blockRequest.php",e).then((e=>{console.log(e)}),(e=>{this.$message.error(e)}))}},Oe=Te,Me=(0,d.Z)(Oe,$e,je,!1,null,"6d952560",null),Ce=Me.exports,Ae=function(){var e=this,t=e._self._c;return t("a-result",{attrs:{status:"warning",title:"请求的IP已加入黑名单","sub-title":"您已拒绝了此次请求，请求的IP地址已被加入黑名单."}})},Se=[],Ue={name:"EmailRefuese",data(){return{}},mounted(){const e=new FormData;e.append("BlockID",this.$route.params.id),e.append("RequestType","refused"),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/blockRequest.php",e).then((e=>{console.log(e)}),(e=>{this.$message.error(e)}))}},De=Ue,Ne=(0,d.Z)(De,Ae,Se,!1,null,"dd8a3416",null),Ie=Ne.exports,ze=function(){var e=this,t=e._self._c;return t("a-result",{staticStyle:{"margin-top":"10%"},attrs:{title:"您的账户已触发安全警报"},scopedSlots:e._u([{key:"extra",fn:function(){return[e._v(" "+e._s("我们"+e.$route.query["msg"]+"，请到邮箱中确认操作!")+" "),t("br"),t("br"),t("br"),t("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.checkLogin()}}},[e._v(" 检查 ")])]},proxy:!0}])})},Ee=[],Pe={name:"BlockLogin",data(){return{}},mixins:[c],methods:{checkLogin(){const e=new FormData;e.append("username",this.$route.query.username),e.append("password",this.$route.query.password),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/login.php",e).then((e=>{let t=e.data;200===t.code?(t={...t,username:this.$route.query.username},this.$store.commit("UserOptions/LOGIN",t),this.$store.dispatch("UserOptions/UserAccess",{userid:t.userid,accessToken:t.accessToken}),this.$message.success("登录成功"),this.setCookie("token",t.token,.5),this.setCookie("userid",t.userid,.5),this.setCookie("accessToken",t.accessToken,.5),this.setCookie("username",t.username,.5),setTimeout((()=>{this.$router.push("/app")}),500)):900===t.code?this.$message.error("您的账户尚未解除安全警报，无法登录!"):0===t.code?this.$router.push({path:"/blockIP"}):this.$message.error(t.text)}),(e=>{this.$message.error(e)}))}}},Ze=Pe,Le=(0,d.Z)(Ze,ze,Ee,!1,null,"c22db4de",null),qe=Le.exports,Be=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mainContainer",staticStyle:{"margin-top":"8%","align-content":"center","justify-content":"center",width:"40%","margin-left":"30%"}},[t("a-result",{attrs:{status:"error",title:"您的IP已被封禁","sub-title":"请联系管理员"},scopedSlots:e._u([{key:"extra",fn:function(){},proxy:!0}])},[t("div",{staticClass:"desc"},[t("p",{staticStyle:{"font-size":"16px"}},[t("strong",[e._v("可能的问题:")])]),t("p",[t("a-icon",{style:{color:"red"},attrs:{type:"close-circle"}}),e._v(" 您曾尝试登录他人账号 ")],1),t("p",[t("a-icon",{style:{color:"red"},attrs:{type:"close-circle"}}),e._v(" 您所在的IP段有人恶意登录/攻击，请联系管理员解封 ")],1)])])],1)},Fe=[],Re={name:"NoAccess",data(){return{}},methods:{}},Ye=Re,He=(0,d.Z)(Ye,Be,Fe,!1,null,"f1ae6e8a",null),Ge=He.exports,Je=function(){var e=this,t=e._self._c;return t("div",{staticClass:"mainContainer",staticStyle:{"margin-top":"8%","align-content":"center","justify-content":"center",width:"40%","margin-left":"30%"}},[t("a-result",{attrs:{status:"success",title:"登出成功","sub-title":e.subTitle},scopedSlots:e._u([{key:"extra",fn:function(){},proxy:!0}])})],1)},Ve=[],We={name:"UserLogout",data(){return{subTitle:"1s后自动跳转至首页"}},mixins:[c],methods:{goIndex(){this.$router.replace("/login")}},mounted(){this.clearCookies(),this.$store.state.UserOptions.users={id:"",token:"",access:"",username:"未登录",accessN:""};let e=1,t=setInterval((()=>{e--,this.subTitle=e+"s后自动跳转至首页"}),1e3);setTimeout((()=>{clearInterval(t),this.goIndex()}),1e3)}},Ke=We,Qe=(0,d.Z)(Ke,Je,Ve,!1,null,"37a48a88",null),Xe=Qe.exports,et=function(){var e=this,t=e._self._c;return t("div",[t("a-page-header",{staticStyle:{border:"1px solid rgb(235, 237, 240)"},attrs:{title:"编辑药品","sub-title":""},on:{back:()=>{this.$router.go(-1)}}}),t("a-form-model",{ref:"ruleForm",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[t("br"),t("br"),t("a-form-model-item",{ref:"creatorID",attrs:{label:"创建者ID"}},[t("a-input",{attrs:{disabled:"true"},model:{value:e.form.creator,callback:function(t){e.$set(e.form,"creator",t)},expression:"form.creator"}})],1),t("a-form-model-item",{ref:"name",attrs:{label:"药品名称",prop:"name"}},[t("a-input",{on:{blur:()=>{e.$refs.name.onFieldBlur()}},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),t("a-form-model-item",{attrs:{label:"拥有数量(单位)",prop:"have"}},[t("span",[e._v(e._s(e.form.have))]),t("a-icon",{directives:[{name:"show",rawName:"v-show",value:e.inEditingMode,expression:"inEditingMode"}],staticStyle:{"margin-left":"0.5%","margin-right":"0.5%"},attrs:{type:"plus"}}),t("a-input-number",{directives:[{name:"show",rawName:"v-show",value:e.inEditingMode,expression:"inEditingMode"}],attrs:{min:-1e6,max:1e6,step:.1},model:{value:e.addNumber,callback:function(t){e.addNumber=t},expression:"addNumber"}}),e._v("    "),t("a-button",{directives:[{name:"show",rawName:"v-show",value:!e.inEditingMode,expression:"!inEditingMode"}],staticStyle:{"margin-left":"0.5%"},attrs:{type:"primary",shape:"circle",icon:"edit",size:"small"},on:{click:function(t){e.inEditingMode=!0,e.addNumber=0}}}),t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.inEditingMode,expression:"inEditingMode"}],staticStyle:{"margin-left":"0.5%"},attrs:{type:"default",shape:"circle",icon:"close",size:"small"},on:{click:function(t){e.inEditingMode=!1}}}),t("a-button",{directives:[{name:"show",rawName:"v-show",value:e.inEditingMode,expression:"inEditingMode"}],staticStyle:{"margin-left":"0.5%"},attrs:{type:"primary",shape:"circle",icon:"check",size:"small"},on:{click:function(t){e.inEditingMode=!1,e.form.have+=e.addNumber}}})],1),t("a-form-model-item",{ref:"room",attrs:{label:"科室",prop:"room"}},[t("a-input",{on:{blur:()=>{e.$refs.room.onFieldBlur()}},model:{value:e.form.room,callback:function(t){e.$set(e.form,"room",t)},expression:"form.room"}})],1),t("a-form-model-item",{attrs:{label:"所属人"}},[t("a-select",{attrs:{placeholder:"请选择药品的所属人","default-value":e.form.BelongTo},model:{value:e.form.BelongTo,callback:function(t){e.$set(e.form,"BelongTo",t)},expression:"form.BelongTo"}},e._l(e.name_listo,(function(s){return t("a-select-option",{key:s,attrs:{value:s}},[e._v(" "+e._s(s)+" ")])})),1)],1),t("a-form-model-item",{attrs:{label:"药品用法",prop:"usage"}},[e._v(" 一天"),t("a-input-number",{attrs:{id:"usage_times",min:1,max:10,size:"small"},on:{change:e.onChange},model:{value:e.form.usage.times,callback:function(t){e.$set(e.form.usage,"times",t)},expression:"form.usage.times"}}),e._v(" 次, 一次"),t("a-input-number",{attrs:{id:"usage_once",min:.1,max:10,step:.1,size:"small"},on:{change:e.onChange},model:{value:e.form.usage.once,callback:function(t){e.$set(e.form.usage,"once",t)},expression:"form.usage.once"}}),e._v("个(单位) ")],1),t("a-form-model-item",{attrs:{label:"状态"}},[t("a-switch",{model:{value:e.form.open,callback:function(t){e.$set(e.form,"open",t)},expression:"form.open"}})],1),t("a-form-model-item",{attrs:{label:"描述",prop:"desc"}},[t("a-input",{attrs:{type:"textarea"},model:{value:e.form.desc,callback:function(t){e.$set(e.form,"desc",t)},expression:"form.desc"}})],1),t("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:4}}},[t("a-button",{attrs:{type:"primary"},on:{click:e.showModal}},[e._v(" 提交 ")])],1)],1),t("a-modal",{attrs:{title:"请确认你所做的更改","ok-text":"确认","cancel-text":"取消"},on:{ok:e.submit},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[t("p",{domProps:{innerHTML:e._s(e.whereChanged.str)}})])],1)},tt=[],st={data(){return{labelCol:{span:4},wrapperCol:{span:14},other:"",name_list:[],addNumber:0,inEditingMode:!1,form:{name:this.$store.state.MedicineOptions.item.name,desc:this.$store.state.MedicineOptions.item.description,room:this.$store.state.MedicineOptions.item.room,stat:this.$store.state.MedicineOptions.item.stat,open:!0,endby:this.$store.state.MedicineOptions.item.endby,endbyT:this.$store.state.MedicineOptions.item.endbyT,creator:this.$store.state.MedicineOptions.item.creatorID,BelongTo:this.$store.state.MedicineOptions.item.BelongTo,usage:{once:this.$store.state.MedicineOptions.item.usage.once,times:this.$store.state.MedicineOptions.item.usage.times},have:0},org_form:{name:this.$store.state.MedicineOptions.item.name,desc:this.$store.state.MedicineOptions.item.description,room:this.$store.state.MedicineOptions.item.room,stat:this.$store.state.MedicineOptions.item.stat,open:!0,endby:this.$store.state.MedicineOptions.item.endby,endbyT:this.$store.state.MedicineOptions.item.endbyT,creator:this.$store.state.MedicineOptions.item.creatorID,BelongTo:this.$store.state.MedicineOptions.item.BelongTo,usage:{once:this.$store.state.MedicineOptions.item.usage.once,times:this.$store.state.MedicineOptions.item.usage.times},have:0},whereChanged:{str:"",cgs:[]},visible:!1,rules:{name:[{required:!0,message:"请输入药品名称",trigger:"blur"},{min:2,max:12,message:"长度必须为2~12位",trigger:"blur"}]}}},methods:{showModal(){this.findWhereChanged(),0!==this.whereChanged.cgs.length?this.visible=!0:this.$message.error("请至少修改一项内容!")},submit(){this.visible=!1;const e=new FormData;e.append("token",this.$store.state.UserOptions.users.token),e.append("userid",this.$store.state.UserOptions.users.id),e.append("accessToken",this.$store.state.UserOptions.users.access),e.append("med_id",this.$store.state.MedicineOptions.item.id),e.append("edit",JSON.stringify(this.whereChanged.cgs)),_.Z.post("https://home.caizhixiao.com.cn/Api/App/User/8yuzxcew97/edit.php",e).then((e=>{200===e.data.code?(this.$message.success(e.data.text),this.$router.replace({name:"SuccessPage"})):this.$message.error(e.data.text)}),(e=>{this.$message.error(e)}))},resetForm(){this.$refs.ruleForm.resetFields()},getNameList(){const e=new FormData;e.append("token",this.$store.state.UserOptions.users.token),e.append("userid",this.$store.state.UserOptions.users.id),e.append("accessToken",this.$store.state.UserOptions.users.access),_.Z.post("https://home.caizhixiao.com.cn/Api/Account/getUserName.php",e).then((e=>(this.name_list=e.data.result,200===e.data.code?e:[])),(e=>{this.$message.error(e)}))},findWhereChanged(){let e="",t=[],s=!1,o=!1,r=!1,a=this.org_form.usage.once*this.org_form.usage.times,i=a;if(this.form.name!==this.org_form.name&&(e+=`<strong class="title">药品名称:</strong>${this.org_form.name}\n                ----\x3e\n                <strong>${this.form.name}</strong><br/>`,t.push({key:"Name",old:this.org_form.name,new:this.form.name})),this.form.have!==this.org_form.have&&(s=!0,e+=`<strong class="title">药品数量:</strong>${this.org_form.have}\n                ----\x3e\n                <strong>${this.form.have}</strong><br/>`),this.form.BelongTo!==this.org_form.BelongTo&&(e+=`<strong class="title">药品所属人:</strong>${this.org_form.BelongTo}\n                ----\x3e\n                <strong>${this.form.BelongTo}</strong><br/>`,t.push({key:"BelongTo",old:this.org_form.BelongTo,new:this.form.BelongTo})),this.form.usage.times!==this.org_form.usage.times&&(o=!0,e+=`<strong class="title">药品用法:</strong>一天${this.org_form.usage.times}次\n                ----\x3e\n                <strong>一天${this.form.usage.times}次</strong><br/>`),this.form.usage.once!==this.org_form.usage.once&&(o=!0,e+=`<strong class="title">药品用法:</strong>一次${this.org_form.usage.once}个(单位)\n                ----\x3e\n                <strong>一次${this.form.usage.once}个(单位)</strong><br/>`),this.form.room!==this.org_form.room&&(e+=`<strong class="title">药品科室:</strong>${this.org_form.room}\n                ----\x3e\n                <strong>${this.form.room}</strong><br/>`,t.push({key:"Room",old:this.org_form.room,new:this.form.room})),this.form.open!==this.org_form.open&&(r=!0,e+=`<strong class="title">药品状态:</strong>${!0===this.org_form.open?"开启":"关闭"}\n                ----\x3e\n                <strong>${!0===this.form.open?"开启":"关闭"}</strong><br/>`),this.form.desc!==this.org_form.desc&&(e+=`<strong class="title">药品描述:</strong>${this.org_form.desc}\n                ----\x3e\n                <strong>${this.form.desc}</strong><br/>`,t.push({key:"Description",old:this.org_form.desc,new:this.form.desc})),!0===o&&(i=a,a=this.form.usage.once*this.form.usage.times,t.push({key:"DailyUse",old:JSON.stringify(this.org_form.usage),new:JSON.stringify(this.form.usage)}),!1===s))if(this.form.stat>=0)t.push({key:"Stat",old:this.org_form.stat,new:Math.floor(this.form.stat*i/a)});else{let e=new Date;e.setDate(e.getDate()+Math.floor(this.form.endby*i/a)),t.push({key:"EndBy",old:this.org_form.endbyT,new:e})}if(!0===s){let e=Math.floor(Math.abs(this.form.have-this.org_form.have)/a);if(this.form.have-this.org_form.have<0&&(e=-e),r=!1,!1===this.form.open)!1===this.org_form.open?t.push({key:"Stat",old:this.org_form.stat,new:Math.floor(this.form.stat*i/a)+e}):t.push({key:"Stat",old:this.org_form.stat,new:Math.floor(this.form.endby*i/a)+e});else if(!0===this.org_form.open){let s=new Date;s.setDate(s.getDate()+Math.floor(this.form.endby*i/a)+e),t.push({key:"Endby",old:this.org_form.endbyT,new:s})}else{let s=new Date;s.setDate(s.getDate()+e+Math.floor(this.form.stat*i/a)),t.push({key:"Endby",old:this.org_form.endbyT,new:new Date(s)}),t.push({key:"Stat",old:this.org_form.stat,new:-1})}}if(!0===r)if(!0===this.form.open){t.push({key:"Stat",old:this.org_form.stat,new:-1});let e=new Date;e.setDate(e.getDate()+Math.floor(this.org_form.stat)),t.push({key:"EndBy",old:this.org_form.endbyT,new:e})}else t.push({key:"Stat",old:-1,new:Math.floor(this.form.have/(this.form.usage.once*this.form.usage.times))});let n={};for(let l=0;l<t.length;l++)n[t[l].key]={new:t[l].new,old:t[l].old};let c={str:e,cgs:n};this.whereChanged=c}},computed:{name_listo(){return this.name_list.filter((e=>-1===e.indexOf("testAccount")))}},mounted(){setTimeout((()=>{this.getNameList(),this.form.have=Math.floor(this.form.usage.times*this.form.usage.once*(this.form.stat>=0?this.form.stat:this.form.endby)),this.org_form.have=this.form.have,this.org_form.open=this.form.open="-1"===this.org_form.stat,void 0===this.form.creator&&this.$message.error("无法获取UID，请刷新重试!")}),100)}},ot=st,rt=(0,d.Z)(ot,et,tt,!1,null,"1ef0a6f7",null),at=rt.exports,it=function(){var e=this,t=e._self._c;return t("div",[t("a-result",{directives:[{name:"show",rawName:"v-show",value:0===e.err,expression:"err === 0"}],attrs:{status:"404",title:"询问","sub-title":e.msg+"。是否为您本人操作"},scopedSlots:e._u([{key:"extra",fn:function(){return[t("a-button",{attrs:{type:"primary",size:"large"},on:{click:function(t){return e.$router.replace("/email_accepted/"+e.$route.params.id)}}},[e._v("是")]),e._v("     "),t("a-button",{attrs:{type:"danger",size:"large"},on:{click:function(t){return e.$router.replace("/email_refused/"+e.$route.params.id)}}},[e._v("否")])]},proxy:!0}])}),t("a-result",{directives:[{name:"show",rawName:"v-show",value:1===e.err,expression:"err === 1"}],attrs:{status:"warning",title:"询问不存在","sub-title":"该询问不存在或已被回答"}}),t("a-result",{directives:[{name:"show",rawName:"v-show",value:2===e.err,expression:"err === 2"}],attrs:{status:"error",title:"错误","sub-title":"路径中包含非法字符"}})],1)},nt=[];s(98858),s(61318),s(33228);const ct=new URLSearchParams(window.location.search);var lt={name:"AskDecision",data(){return{msg:ct.get("msg"),err:0}},mounted(){_.Z.get("https://home.caizhixiao.com.cn/Api/Account/ExisitAsking.php?ID="+this.$route.params.id).then((e=>{switch(e.data.code){case 200:break;case-200:this.err=1;break;case 0:this.$router.replace("/BlockIP");break;case-403:this.err=2;break;default:break}}))}},mt=lt,ut=(0,d.Z)(mt,it,nt,!1,null,"95582112",null),dt=ut.exports;const pt=j.ZP.prototype.push;j.ZP.prototype.push=function(e){return pt.call(this,e).catch((e=>e))};const ht=new j.ZP({mode:"history",routes:[{path:"/",name:"home_user_login",component:S,meta:{requireAuth:0}},{path:"/login",name:"user_login",component:S,meta:{requireAuth:0}},{path:"/logout",name:"user_logout",component:Xe,meta:{requireAuth:1}},{path:"/email_accepted/:id",name:"verAcc",component:Ce},{path:"/email_refused/:id",name:"refAcc",component:Ie},{path:"/blocked",name:"block",component:qe},{path:"/blockIP",name:"blockIP",component:Ge},{path:"/AskDecision/:id",name:"AskDecision",component:dt},{path:"/home",name:"home",component:E,meta:{requireAuth:1}},{path:"/noAccess",name:"noAccess",component:ae},{path:"/app",name:"MyApp",component:R,children:[{path:"8yuzxcew97",name:"MedicineList",component:X,children:[{path:"add",name:"MedicineAdd",component:ue,meta:{requireAuth:1}},{path:"detail",name:"MedicineDetails",component:be,meta:{requireAuth:1}},{path:"edit",name:"MedicineEdit",component:at,meta:{requireAuth:1}},{path:"success",name:"SuccessPage",component:xe,meta:{requireAuth:1}}],meta:{requireAuth:1}}],meta:{requireAuth:1}}]});let gt={getCookie(e){let t=e+"=",s=document.cookie.split(";");for(let o=0;o<s.length;o++){let e=s[o].trim();if(0===e.indexOf(t))return e.substring(t.length,e.length)}return""}};ht.beforeEach(((e,t,s)=>{if(e.meta.requireAuth){if(""===gt.getCookie("userid"))return void s("noAccess");let t=$.state.UserOptions.users.accessN;if(""===t){let o={token:gt.getCookie("token"),userid:gt.getCookie("userid"),accessToken:gt.getCookie("accessToken"),username:gt.getCookie("username")};$.commit("UserOptions/LOGIN",o),$.dispatch("UserOptions/UserAccess",{userid:gt.getCookie("userid"),accessToken:gt.getCookie("accessToken")}).then((()=>{setTimeout((()=>{t=$.state.UserOptions.users.accessN,console.log(t),t>=e.meta.requireAuth?s():s("noAccess")}),1e3)}))}else t>=e.meta.requireAuth?s():s("noAccess")}else s()}));var ft=ht;o.ZP.config.productionTip=!1,o.ZP.use(k.ZP),o.ZP.use(j.ZP),new o.ZP({el:"#app",render:e=>e(v),store:$,router:ft,beforeCreate(){o.ZP.prototype.$bus=this}})}},t={};function s(o){var r=t[o];if(void 0!==r)return r.exports;var a=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(a.exports,a,a.exports,s),a.loaded=!0,a.exports}s.m=e,function(){var e=[];s.O=function(t,o,r,a){if(!o){var i=1/0;for(m=0;m<e.length;m++){o=e[m][0],r=e[m][1],a=e[m][2];for(var n=!0,c=0;c<o.length;c++)(!1&a||i>=a)&&Object.keys(s.O).every((function(e){return s.O[e](o[c])}))?o.splice(c--,1):(n=!1,a<i&&(i=a));if(n){e.splice(m--,1);var l=r();void 0!==l&&(t=l)}}return t}a=a||0;for(var m=e.length;m>0&&e[m-1][2]>a;m--)e[m]=e[m-1];e[m]=[o,r,a]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var r,a,i=o[0],n=o[1],c=o[2],l=0;if(i.some((function(t){return 0!==e[t]}))){for(r in n)s.o(n,r)&&(s.m[r]=n[r]);if(c)var m=c(s)}for(t&&t(o);l<i.length;l++)a=i[l],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(m)},o=self["webpackChunkhome_website"]=self["webpackChunkhome_website"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[998],(function(){return s(11516)}));o=s.O(o)})();